from idaapi import *
from idautils import *
from idc import *



for f in Functions(idc.get_segm_start(0x00000000006F521D), idc.get_segm_end(0x00000000006F521D)):
	with open("C:\\users\\pc\\desktop\\out.txt", 'a') as x:
		name = idc.get_func_name(f)
		if name.endswith("exploit"):
			print("\n============= " + name +" =============\n")
			x.write("\n\n============= " + name +" =============\n\n")
			dism_addr = list(FuncItems(f))
			for line in dism_addr:
				print(f"{hex(line)}       {idc.generate_disasm_line(line,0)}")
				x.write(f"{hex(line)}       {idc.generate_disasm_line(line,0)}"+"\n")
